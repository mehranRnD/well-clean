<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Well Clean - Pricing</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="" name="keywords" />
    <meta content="" name="description" />
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="img/favicon-32x32.png" />
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap"
      rel="stylesheet"
    />

    <!-- Icon Font Stylesheet -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet" />
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet" />
    <style>
      .navbar-light .navbar-nav .nav-link {
        color: #393838;
      }
    </style>
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=ASNGhKzEe51oF20pg75Uv28jRFOZD1kKmpWS35DsKL9tJBM2BjLJ1XnfmJNjASOFNYQA6jDqMvM5BV0r&currency=GBP"></script>
  </head>

  <body>
    <!-- Spinner Start -->
    <div
      id="spinner"
      class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center"
    >
      <div
        class="spinner-border text-primary"
        style="width: 3rem; height: 3rem"
        role="status"
      >
        <span class="sr-only">Loading...</span>
      </div>
    </div>
    <!-- Spinner End -->
    <!-- Social Media Sticky Buttons -->
    <div class="social-icons">
      <a
        href="https://wa.me/447398538498"
        class="social-btn whatsapp"
        target="_blank"
      >
        <i class="fab fa-whatsapp"></i>
      </a>

      <a
        href="https://www.facebook.com/well-clean"
        class="social-btn facebook"
        target="_blank"
      >
        <i class="fab fa-facebook-f"></i>
      </a>

      <a
        href="https://www.instagram.com/well-clean"
        class="social-btn instagram"
        target="_blank"
      >
        <i class="fab fa-instagram"></i>
      </a>
      <a
        href="https://www.linkedin.com/company/well-clean/"
        class="social-btn linkedin"
        target="_blank"
      >
        <i class="fab fa-linkedin-in"></i>
      </a>
    </div>
    <!-- Navbar & Hero Start -->
    <div class="container-fluid position-relative p-0">
      <nav
        class="navbar navbar-expand-lg navbar-light px-4 px-lg-5 py-3 py-lg-0"
      >
        <a href="/" class="navbar-brand p-0">
          <!-- <h1 class="text-primary"><i class="fas fa-hand-holding-water me-3"></i>Well Clean</h1> -->
          <img src="img/testing-logo-2.png" alt="Logo" />
        </a>
        <button class="navbar-toggler" type="button">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarCollapse">
          <div class="navbar-nav ms-auto py-0">
            <a href="/" class="nav-item nav-link nav-link">Home</a>
            <a href="/about" class="nav-item nav-link">About</a>
            <a href="/service" class="nav-item nav-link">Services</a>
            <a href="/pricing" class="nav-item nav-link active">Pricing</a>
            <a href="/contact" class="nav-item nav-link">Contact</a>
          </div>
          <div class="d-none d-xl-flex me-3">
            <div class="d-flex flex-column pe-3 border-end border-primary">
              <a href="tel:+441733964472"
                ><span class="text-primary">Free: +441733964472</span></a
              >
            </div>
          </div>
        </div>
      </nav>

      <!-- Header Start -->
      <!-- <div class="container-fluid bg-breadcrumb">
        <div class="container text-center py-5" style="max-width: 900px">
          <h4
            class="text-white display-4 mb-4 wow fadeInDown"
            data-wow-delay="0.1s"
          >
            Our Services
          </h4>
        </div>
      </div> -->
      <!-- Header End -->
    </div>
    <!-- Navbar & Hero End -->

    <!-- Availability Section -->
    <!-- <div class="container-fluid cleaning-services-section">
      <div class="container">
        <div class="container-fluid booking-section">
          <div class="container">
            <div class="row justify-content-center">
              <div class="col-12 text-center">
                <section class="avail-body">
                  <div class="container">
                    <h2 class="avail-heading">Our Availability</h2>
                    <p
                      class="text-muted text-center mb-4"
                      style="max-width: 1000px; margin: 0 auto 1rem"
                    >
                      Check our available time slots below. Today's availability
                      is highlighted for your convenience.
                    </p>
                    <div class="avail-container" id="availability-cards">
                   
                      <div
                        class="avail-card loading-state"
                        style="
                          grid-column: 1 / -1;
                          text-align: center;
                          padding: 30px;
                        "
                      >
                        <div
                          class="spinner-border text-primary"
                          role="status"
                          style="width: 2.5rem; height: 2.5rem"
                        >
                          <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3 mb-0">Loading availability...</p>
                      </div>
                    </div>
                  </div>
                  
                </section>
              </div>
              
            </div>
          
        </div>
      </div>
    </div> -->

    <!-- Services Section -->
    <div class="container-fluid cleaning-services-section">
      <div class="container">
        <div class="container-fluid booking-section">
          <div class="container">
            <div class="row justify-content-center">
              <div class="col-12 text-center">
                <h2 class="text-uppercase my-4">Online Booking</h2>
                <div class="pricing-btn-container">
                  <button class="pricing-btn active" id="oneOffBtn">
                    One-off domestic clean
                  </button>
                  <button class="pricing-btn" id="regularBtn">
                    Regular cleaning
                  </button>
                </div>
              </div>
            </div>

            <div class="row justify-content-center">
              <div class="col-lg-7">
                <div
                  id="oneOffSection"
                  class="booking-section mb-4"
                  style="display: block"
                >
                  <div class="card shadow-sm">
                    <div class="card-body">
                      <h3 class="card-title mb-4">One-Off Cleaning</h3>
                      <form id="oneOffForm">
                        <div class="mb-4">
                          <label for="oneOffRoomSize" class="form-label"
                            >Size of House *</label
                          >
                          <select
                            id="oneOffRoomSize"
                            class="form-select"
                            name="oneOffRoomSize"
                            required
                          >
                            <option value="">Select size</option>
                            <option value="1-bed flat">1-bed flat</option>
                            <option value="2-bed, 1-bath">2-bed, 1-bath</option>
                            <option value="3-bed, 1-2 bath">
                              3-bed, 1-2 bath
                            </option>
                            <option value="4-bed, 2-bath">4-bed, 2-bath</option>
                            <option value="5-bed, 2-3 bath">
                              5-bed, 2-3 bath
                            </option>
                            <option value="6+ bedrooms / large homes">
                              6+ bedrooms / large homes
                            </option>
                          </select>
                        </div>
                        <div class="mb-4">
                          Type of Clean
                          <select
                            class="form-select mb-4"
                            id="oneOffCleaningType"
                            required
                          >
                            <option value="">Select type of clean</option>
                            <option value="Light">Light Clean</option>
                            <option value="Standard">Standard Clean</option>
                            <option value="Deep">Deep Clean</option>
                          </select>
                        </div>
                        <div class="mb-4">
                          <label for="oneOffDate" class="form-label"
                            >Preferred Date *</label
                          >
                          <input
                            type="date"
                            class="form-control"
                            id="oneOffDate"
                            name="oneOffDate"
                            required
                          />
                        </div>
                        <div class="mb-4">
                          <label for="oneOffTime" class="form-label"
                            >Preferred Time *</label
                          >
                          <input
                            type="time"
                            class="form-control"
                            id="oneOffTime"
                            name="oneOffTime"
                            required
                          />
                        </div>
                        <h5 class="mt-4 mb-3">Contact Information</h5>
                        <div class="row">
                          <div class="col-md-6 mb-3">
                            <label for="fullName" class="form-label"
                              >Full Name *</label
                            >
                            <textarea
                              class="form-control"
                              id="fullName"
                              name="fullName"
                              rows="1"
                            ></textarea>
                          </div>
                          <div class="col-md-6 mb-3">
                            <label for="email" class="form-label"
                              >Email Address *</label
                            >
                            <input
                              type="email"
                              class="form-control"
                              id="email"
                              required
                            />
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6 mb-3">
                            <label for="phone" class="form-label"
                              >Phone Number *</label
                            >
                            <input
                              type="tel"
                              class="form-control"
                              id="phone"
                              required
                            />
                          </div>
                          <div class="col-md-6 mb-3">
                            <label for="alternatePhone" class="form-label"
                              >Alternate Phone</label
                            >
                            <input
                              type="tel"
                              class="form-control"
                              id="alternatePhone"
                            />
                          </div>
                        </div>
                        <h5 class="mt-4 mb-3">Address Information</h5>
                        <div class="mb-3">
                          <label for="address" class="form-label"
                            >Address *</label
                          >
                          <textarea
                            class="form-control"
                            id="address"
                            rows="2"
                            required
                          ></textarea>
                        </div>
                        <div class="row">
                          <div class="col-md-4 mb-3">
                            <label for="postcode" class="form-label"
                              >Postcode *</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              id="postcode"
                              required
                            />
                          </div>
                          <div class="col-md-4 mb-3">
                            <label for="city" class="form-label">City *</label>
                            <input
                              type="text"
                              class="form-control"
                              id="city"
                              required
                            />
                          </div>
                          <div class="col-md-4 mb-3">
                            <label for="country" class="form-label"
                              >Country *</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              name="country"
                              id="country"
                              required
                            />
                          </div>
                        </div>
                        <div class="mb-4">
                          <label for="oneOffNotes" class="form-label"
                            >Special Instructions</label
                          >
                          <textarea
                            class="form-control"
                            name="oneOffNotes"
                            id="oneOffNotes"
                            rows="3"
                          ></textarea>
                        </div>
                        <div class="text-end">
                          <button
                            type="button"
                            class="btn btn-primary px-4 py-2"
                            onclick="validateAndSubmit('oneOffForm')"
                          >
                            <i class="fas fa-calendar-check me-2"></i>Book Now
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>

                <!-- Regular Cleaning Section -->
                <div
                  id="regularSection"
                  class="booking-section"
                  style="display: none"
                >
                  <div class="card shadow-sm">
                    <div class="card-body">
                      <h3 class="card-title mb-4">Regular Cleaning</h3>
                      <form id="regularForm">
                        <div class="mb-4">
                          <label for="regularRoomSize" class="form-label"
                            >Size of House *</label
                          >
                          <select
                            class="form-select"
                            name="regularRoomSize"
                            id="regularRoomSize"
                            required
                          >
                            <option value="">Select size</option>
                            <option value="1-2">1-2 Rooms</option>
                            <option value="3-4">3-4 Rooms</option>
                            <option value="5+">5+ Rooms</option>
                          </select>
                        </div>

                        <div class="mb-4">
                          <label for="regularFrequency" class="form-label"
                            >Cleaning Frequency *</label
                          >
                          <select
                            class="form-select"
                            name="regularFrequency"
                            id="regularFrequency"
                            required
                          >
                            <option value="">Select frequency</option>
                            <option value="weekly">Weekly/Bi-Weekly</option>
                            <option value="monthly">Monthly</option>
                          </select>
                        </div>
                        <div class="mb-4">
                          <label for="regularDate" class="form-label"
                            >Start Date *</label
                          >
                          <input
                            type="date"
                            class="form-control"
                            name="regularDate"
                            id="regularDate"
                            required
                          />
                        </div>
                        <h5 class="mt-4 mb-3">Contact Information</h5>
                        <div class="row">
                          <div class="col-md-6 mb-3">
                            <label for="name" class="form-label"
                              >Full Name *</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              name="name"
                              id="name"
                              required
                            />
                          </div>
                          <div class="col-md-6 mb-3">
                            <label for="emailLabel" class="form-label"
                              >Email Address *</label
                            >
                            <input
                              type="email"
                              class="form-control"
                              name="emailLabel"
                              id="emailLabel"
                              required
                            />
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6 mb-3">
                            <label for="phoneLabel" class="form-label"
                              >Phone Number *</label
                            >
                            <input
                              type="tel"
                              class="form-control"
                              name="phoneLabel"
                              id="phoneLabel"
                              required
                            />
                          </div>
                          <div class="col-md-6 mb-3">
                            <label for="alternatePhoneLabel" class="form-label"
                              >Alternate Phone</label
                            >
                            <input
                              type="tel"
                              class="form-control"
                              name="alternatePhoneLabel"
                              id="alternatePhoneLabel"
                            />
                          </div>
                        </div>
                        <h5 class="mt-4 mb-3">Address Information</h5>
                        <div class="mb-3">
                          <label for="addressLabel" class="form-label"
                            >Address *</label
                          >
                          <textarea
                            class="form-control"
                            name="addressLabel"
                            id="addressLabel"
                            rows="2"
                            required
                          ></textarea>
                        </div>
                        <div class="row">
                          <div class="col-md-4 mb-3">
                            <label for="postcodeLabel" class="form-label"
                              >Postcode *</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              name="postcodeLabel"
                              id="postcodeLabel"
                              required
                            />
                          </div>
                          <div class="col-md-4 mb-3">
                            <label for="cityLabel" class="form-label"
                              >City *</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              name="cityLabel"
                              id="cityLabel"
                              required
                            />
                          </div>
                          <div class="col-md-4 mb-3">
                            <label for="countryLabel" class="form-label"
                              >Country *</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              name="countryLabel"
                              id="countryLabel"
                              required
                            />
                          </div>
                        </div>
                        <div class="mb-4">
                          <label for="regularNotes" class="form-label"
                            >Special Instructions *</label
                          >
                          <textarea
                            class="form-control"
                            name="regularNotesLabel"
                            id="regularNotesLabel"
                            rows="3"
                            required
                          ></textarea>
                        </div>
                        <div class="text-end">
                          <button
                            type="button"
                            class="btn btn-primary px-4 py-2"
                            id="bookNowBtn"
                            onclick="validateAndSubmit('regularForm')"
                          >
                            <i class="fas fa-calendar-check me-2"></i>Book Now
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Right Side: Pricing Calculator -->
              <div class="col-lg-5 col-xl-4">
                <div class="card shadow-sm h-auto">
                  <div class="card-body">
                    <h4 class="card-title mb-3">Pricing</h4>
                    <div class="pricing-calculator">
                      <div class="price-display mb-3">
                        <h5 class="mb-1">Estimated Price</h5>
                        <h2 class="text-primary mb-0" id="totalPrice">£0.00</h2>
                      </div>

                      <div class="price-breakdown">
                        <div class="mb-2">
                          <h6 class="mb-1">Service Type</h6>
                          <p id="serviceType">Select a service type</p>
                        </div>
                        <div class="mb-2">
                          <h6 class="mb-1">House Size</h6>
                          <p id="houseSize">Select house size</p>
                        </div>
                        <div class="mb-2">
                          <h6 class="mb-1">Cleaning Type</h6>
                          <p id="cleaningType">Select cleaning type</p>
                        </div>
                        <div
                          class="mb-2"
                          id="frequencySection"
                          style="display: none"
                        >
                          <h6 class="mb-1">Cleaning Frequency</h6>
                          <p id="cleaningFrequency">Select frequency</p>
                        </div>
                        <div class="mb-2">
                          <h6 class="mb-1">Price Range</h6>
                          <p id="priceRange">
                            Select options to see price range
                          </p>
                        </div>
                      </div>

                      <div class="price-details mt-3">
                        <h6 class="mb-2">Price Details</h6>
                        <div class="price-item mb-1">
                          <span>Base Price</span>
                          <span id="basePrice">£0.00</span>
                        </div>
                        <div
                          class="price-item mb-1"
                          id="hourlyRateSection"
                          style="display: none"
                        >
                          <span>Hourly Rate</span>
                          <span id="hourlyRate">£0.00</span>
                        </div>
                        <div
                          class="price-item mb-1"
                          id="monthlyRateSection"
                          style="display: none"
                        >
                          <span>Monthly Rate</span>
                          <span id="monthlyRate">£0.00</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <a href="#" id="cleanTypeLink"
                  >Click here for clean type details</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add this CSS to your existing styles -->
    <style>
      .cleaning-services-section {
        background-color: #f8f9fa;
        padding: 80px 0;
      }

      .cleaning-service-tabs {
        gap: 1rem;
      }

      .cleaning-service-tab {
        background: white;
        border: 2px solid #f1f1f1;
        padding: 1rem 2rem;
        border-radius: 50px;
        color: #333;
        font-weight: 600;
        transition: all 0.3s ease;
        text-transform: uppercase;
        cursor: pointer;
      }

      .cleaning-service-tab:hover,
      .cleaning-service-tab.active {
        background: #fff;
        border-color: #e1e1e1;
        color: #000;
        transform: translateY(-3px);
      }

      .cleaning-service-tab i {
        font-size: 1.1rem;
      }

      .cleaning-service-card {
        background: white;
        border: 2px solid #f1f1f1;
        border-radius: 15px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
      }

      .cleaning-service-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
      }

      .cleaning-service-card h3 {
        color: #000;
        font-weight: 600;
        margin-bottom: 1.5rem;
      }

      .cleaning-service-card p {
        color: #666;
        line-height: 1.6;
        font-size: 0.95rem;
      }

      .cleaning-service-features {
        margin: 0;
        padding: 0;
      }

      .cleaning-service-features li {
        margin-bottom: 0.5rem;
        color: #666;
        font-size: 0.9rem;
      }

      .cleaning-service-features i {
        font-size: 0.8rem;
      }

      .cleaning-service-card .btn {
        padding: 0.8rem 1.5rem;
        font-weight: 600;
        transition: all 0.3s ease;
        margin-top: 1.5rem;
      }

      .cleaning-service-card .btn:hover {
        transform: translateX(10px);
      }

      .cleaning-service-card .btn i {
        transition: transform 0.3s ease;
        font-size: 0.9rem;
      }

      .cleaning-service-card .btn:hover i {
        transform: translateX(5px);
      }

      @media (max-width: 768px) {
        .cleaning-service-tabs {
          flex-wrap: wrap;
          justify-content: center;
        }

        .cleaning-service-tab {
          padding: 0.8rem 1.5rem;
          font-size: 0.9rem;
        }

        .cleaning-service-card {
          padding: 2rem;
        }

        .cleaning-service-card h3 {
          font-size: 1.2rem;
        }
      }

      /* Remove content switch animation */
      .cleaning-service-content {
        display: none;
      }

      .cleaning-service-content.active {
        display: block;
      }
    </style>

    <!-- Add this JavaScript to handle the service toggling -->
    <script>
      function getBookingDetails() {
        const isOneOff =
          document.getElementById("oneOffSection").style.display !== "none";
        const form = isOneOff
          ? document.getElementById("oneOffForm")
          : document.getElementById("regularForm");

        const formData = new FormData(form);
        const data = {};

        // Convert FormData to object
        for (let [key, value] of formData.entries()) {
          data[key] = value;
        }

        // Get additional data from the UI
        data.serviceType = isOneOff ? "one-off" : "regular";
        data.houseSize =
          form.querySelector("select[name$='RoomSize']")?.value || "";
        data.cleaningType =
          form.querySelector("select[name$='CleaningType']")?.value || "";
        data.frequency =
          form.querySelector("select[name='frequency']")?.value || "";
        data.totalPrice =
          document.getElementById("totalPrice")?.textContent || "";

        return data;
      }

      document.addEventListener("DOMContentLoaded", function () {
        const oneOffBtn = document.getElementById("oneOffBtn");
        const regularBtn = document.getElementById("regularBtn");
        const oneOffSection = document.getElementById("oneOffSection");
        const regularSection = document.getElementById("regularSection");

        // Pricing data
        const oneOffPrices = {
          "1-bed flat": { Light: 45, Standard: 55, Deep: 100 },
          "2-bed, 1-bath": { Light: 60, Standard: 70, Deep: 120 },
          "3-bed, 1-2 bath": { Light: 70, Standard: 85, Deep: 145 },
          "4-bed, 2-bath": { Light: 90, Standard: 130, Deep: 180 },
          "5-bed, 2-3 bath": { Light: 110, Standard: 150, Deep: 225 },
          "6+ bedrooms / large homes": { Light: 130, Standard: 200, Deep: 275 },
        };

        // Update price display
        function updatePrice() {
          const serviceType =
            oneOffSection.style.display === "block" ? "one-off" : "regular";
          const cleaningType =
            serviceType === "one-off"
              ? document.getElementById("oneOffCleaningType").value
              : document.getElementById("regularCleaningType").value;
          const roomSize =
            serviceType === "one-off"
              ? document.getElementById("oneOffRoomSize").value
              : document.getElementById("regularRoomSize").value;
          const frequency = document.getElementById("regularFrequency").value;

          // Update service type
          const serviceTypeEl = document.getElementById("serviceType");
          if (serviceTypeEl) {
            serviceTypeEl.textContent =
              serviceType === "one-off" ? "One-Off Clean" : "Regular Cleaning";
          }

          // Update house size
          const houseSizeEl = document.getElementById("houseSize");
          if (houseSizeEl) {
            houseSizeEl.textContent = roomSize
              ? `${roomSize} Rooms`
              : "Select house size";
          }

          // Update cleaning type
          const cleaningTypeEl = document.getElementById("cleaningType");
          if (cleaningTypeEl) {
            cleaningTypeEl.textContent = cleaningType
              ? cleaningType === "Light"
                ? "Light Clean"
                : cleaningType === "Standard"
                ? "Standard Clean"
                : "Deep Clean"
              : "Select cleaning type";
          }

          // Update frequency (only for regular)
          const frequencySection = document.getElementById("frequencySection");
          const cleaningFrequencyEl =
            document.getElementById("cleaningFrequency");

          if (serviceType === "regular") {
            if (frequencySection) frequencySection.style.display = "block";
            if (cleaningFrequencyEl) {
              cleaningFrequencyEl.textContent = frequency
                ? frequency === "weekly"
                  ? "Weekly/Bi-Weekly"
                  : "Monthly"
                : "Select frequency";
            }
          } else {
            if (frequencySection) frequencySection.style.display = "none";
          }

          if (roomSize) {
            if (serviceType === "one-off") {
              const price = oneOffPrices[roomSize]?.[cleaningType] || 0;
              document.getElementById(
                "totalPrice"
              ).textContent = `£${price.toFixed(2)}`;
              document.getElementById(
                "basePrice"
              ).textContent = `£${price.toFixed(2)}`;
              document.getElementById("priceRange").textContent =
                price > 0
                  ? `£${price.toFixed(2)}`
                  : "Select options to see price";

              // Hide hourly/monthly sections
              document.getElementById("hourlyRateSection").style.display =
                "none";
              document.getElementById("monthlyRateSection").style.display =
                "none";
            } else if (frequency) {
              const rate = priceData["regular"][frequency];
              document.getElementById(
                "totalPrice"
              ).textContent = `£${rate.toFixed(2)}`;
              document.getElementById(
                "hourlyRate"
              ).textContent = `£${rate.toFixed(2)}`;
              document.getElementById("priceRange").textContent =
                frequency === "weekly"
                  ? `£13.50hr (with cleaning supplies provided) - £14.50`
                  : `£15 per hour`;

              // Show hourly rate section, hide monthly rate
              document.getElementById("hourlyRateSection").style.display =
                "block";
              document.getElementById("monthlyRateSection").style.display =
                "none";
            }
          } else {
            // Reset prices if no selection
            document.getElementById("totalPrice").textContent = "£0.00";
            document.getElementById("serviceType").textContent =
              "Select a service type";
            document.getElementById("houseSize").textContent =
              "Select house size";
            document.getElementById("cleaningFrequency").textContent =
              "Select frequency";
            document.getElementById("priceRange").textContent =
              "Select options to see price range";
            document.getElementById("basePrice").textContent = "£0.00";
            document.getElementById("hourlyRate").textContent = "£0.00";
            document.getElementById("monthlyRate").textContent = "£0.00";
          }
        }

        // Button click handlers
        oneOffBtn.addEventListener("click", function () {
          oneOffSection.style.display = "block";
          regularSection.style.display = "none";
          oneOffBtn.classList.add("btn-primary");
          oneOffBtn.classList.remove("btn-secondary");
          regularBtn.classList.add("btn-secondary");
          regularBtn.classList.remove("btn-primary");
          updatePrice();
        });

        regularBtn.addEventListener("click", function () {
          regularSection.style.display = "block";
          oneOffSection.style.display = "none";
          regularBtn.classList.add("btn-primary");
          regularBtn.classList.remove("btn-secondary");
          oneOffBtn.classList.add("btn-secondary");
          oneOffBtn.classList.remove("btn-primary");
          updatePrice();
        });

        // Form change handlers
        document
          .getElementById("oneOffRoomSize")
          .addEventListener("change", updatePrice);
        document
          .getElementById("regularRoomSize")
          .addEventListener("change", updatePrice);
        document
          .getElementById("regularFrequency")
          .addEventListener("change", updatePrice);

        // Get booking details from forms
        function getBookingDetailsFromForm() {
          const serviceType =
            document.getElementById("oneOffSection").style.display === "block"
              ? "one-off"
              : "regular";

          // Get common elements
          const fullName = document.getElementById("fullName")?.value || "";
          const email = document.getElementById("email")?.value || "";
          const phone = document.getElementById("phone")?.value || "";
          const alternatePhone =
            document.getElementById("alternatePhone")?.value || "";
          const address = document.getElementById("address")?.value || "";
          const postcode = document.getElementById("postcode")?.value || "";
          const city = document.getElementById("city")?.value || "";
          const country = document.getElementById("country")?.value || "";
          const notes =
            document.getElementById(
              serviceType === "one-off" ? "oneOffNotes" : "regularNotes"
            )?.value || "";

          if (serviceType === "one-off") {
            // One-off specific fields
            const roomSize =
              document.getElementById("oneOffRoomSize")?.value || "";
            const cleaningType =
              document.getElementById("oneOffCleaningType")?.value || "";
            const date = document.getElementById("oneOffDate")?.value || "";
            const time = document.getElementById("oneOffTime")?.value || "";

            const houseSize =
              roomSize === "1-2"
                ? "1-2 Rooms"
                : roomSize === "3-4"
                ? "3-4 Rooms"
                : roomSize === "5+"
                ? "5+ Rooms"
                : "";

            const cleaningTypeDisplay =
              cleaningType === "Light"
                ? "Light Clean"
                : cleaningType === "Standard"
                ? "Standard Clean"
                : cleaningType === "Deep"
                ? "Deep Clean"
                : "";

            return {
              serviceType: "One-Off Cleaning",
              cleaningType: cleaningTypeDisplay,
              cleaningTypeLabel: cleaningType,
              roomSize,
              houseSize,
              date,
              time,
              preferredDate: date,
              preferredTime: time,
              customerName: fullName,
              fullName,
              email,
              phone,
              alternatePhone,
              alternatePhoneNumber: alternatePhone,
              address,
              streetAddress: address,
              postcode,
              zipCode: postcode,
              city,
              country,
              notes,
              specialInstructions: notes,
              status: "pending",
              timestamp: new Date().toISOString(),
            };
          } else {
            // Regular cleaning specific fields
            const roomSize =
              document.getElementById("regularRoomSize")?.value || "";
            const frequency =
              document.getElementById("regularFrequency")?.value || "";
            const date = document.getElementById("regularDate")?.value || "";

            const houseSize =
              roomSize === "1-2"
                ? "1-2 Rooms"
                : roomSize === "3-4"
                ? "3-4 Rooms"
                : roomSize === "5+"
                ? "5+ Rooms"
                : "";

            const frequencyDisplay =
              frequency === "weekly"
                ? "Weekly/Bi-Weekly"
                : frequency === "monthly"
                ? "Monthly"
                : "";

            return {
              serviceType: "Regular Cleaning",
              frequency: frequencyDisplay,
              frequencyValue: frequency,
              roomSize,
              houseSize,
              date,
              preferredDate: date,
              customerName: fullName,
              fullName,
              email,
              phone,
              alternatePhone,
              alternatePhoneNumber: alternatePhone,
              address,
              streetAddress: address,
              postcode,
              zipCode: postcode,
              city,
              country,
              notes,
              specialInstructions: notes,
              status: "pending",
              timestamp: new Date().toISOString(),
            };
          }
        }

        // Form submission handlers
        document
          .getElementById("oneOffForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            // console.log("One-Off Form Submitted");
            const bookingDetails = getBookingDetails();
            // console.log("Booking Details:", bookingDetails);

            // Combine all data
            const bookingData = {
              ...bookingDetails,
              timestamp: new Date().toLocaleString("en-GB", {
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
                hour12: true,
              }),
              status: "pending",
            };

            // Send booking data
            const whatsappMessage = `
              *New Booking Request*
              
              *Customer Details:*
              Name: ${bookingData.fullName}
              Email: ${bookingData.email}
              Phone: ${bookingData.phone}
              Alternate Phone: ${bookingData.alternatePhone}
              
              *Address:*
              ${bookingData.address}
              Postcode: ${bookingData.postcode}
              City: ${bookingData.city}
              Country: ${bookingData.country}
              
              *Service Details:*
              Service Type: ${bookingData.serviceType}
              House Size: ${bookingData.houseSize}
              ${
                bookingData.serviceType === "Regular"
                  ? `Frequency: ${bookingData.time}\n`
                  : `Preferred Time: ${bookingData.time}\nPreferred Time: ${bookingData.preferredTime}\n`
              }
              
              *Additional Notes:*
              ${bookingData.notes}
              
              Status: ${bookingData.status}
              Timestamp: ${bookingData.timestamp}
            `;

            // Open WhatsApp
            const whatsappUrl = `https://wa.me/447398538498?text=${encodeURIComponent(
              whatsappMessage
            )}`;
            window.open(whatsappUrl, "_blank");

            // Reset forms
            document.getElementById("oneOffForm").reset();
            document.getElementById("regularForm").reset();

            // Reset price display
            document.getElementById("totalPrice").textContent = "£0.00";
            document.getElementById("serviceType").textContent =
              "Select a service type";
            document.getElementById("houseSize").textContent =
              "Select house size";
            document.getElementById("cleaningFrequency").textContent =
              "Select frequency";
            document.getElementById("priceRange").textContent =
              "Select options to see price range";
            document.getElementById("basePrice").textContent = "£0.00";
            document.getElementById("hourlyRate").textContent = "£0.00";
            document.getElementById("monthlyRate").textContent = "£0.00";
          });

        document
          .getElementById("regularForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            // console.log("Regular Form Submitted");
            const bookingDetails = getBookingDetails();
            // console.log("Booking Details:", bookingDetails);

            // Get customer details
            const customerDetails = {
              fullName: document.getElementById("fullName")?.value || "",
              email: document.getElementById("email")?.value || "",
              phone: document.getElementById("phone")?.value || "",
              address: document.getElementById("address")?.value || "",
              postcode: document.getElementById("postcode")?.value || "",
              city: document.getElementById("city")?.value || "",
              country: document.getElementById("Country")?.value || "",
              preferredDate:
                document.getElementById("preferredDate")?.value || "",
              preferredTime:
                document.getElementById("preferredTime")?.value || "",
              additionalNotes:
                document.getElementById("regularNotes")?.value || "",
            };

            // console.log("Customer Details:", customerDetails);

            // Combine all data
            const bookingData = {
              ...bookingDetails,
              ...customerDetails,
              timestamp: new Date().toLocaleString("en-GB", {
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
                hour12: true,
              }),
              status: "pending",
            };

            // Send booking data
            const whatsappMessage = `
              *New Booking Request*
              
              *Customer Details:*
              Name: ${bookingData.fullName}
              Email: ${bookingData.email}
              Phone: ${bookingData.phone}
              Alternate Phone: ${bookingData.alternatePhone}
              
              *Address:*
              ${bookingData.address}
              Postcode: ${bookingData.postcode}
              City: ${bookingData.city}
              Country: ${bookingData.country}
              
              *Service Details:*
              Service Type: ${bookingData.serviceType}
              House Size: ${bookingData.houseSize}
              ${
                bookingData.serviceType === "Regular"
                  ? `Frequency: ${bookingData.time}\n`
                  : `Preferred Time: ${bookingData.time}\nPreferred Time: ${bookingData.preferredTime}\n`
              }
              
              *Additional Notes:*
              ${bookingData.notes}
              
              Status: ${bookingData.status}
              Timestamp: ${bookingData.timestamp}
            `;

            // Open WhatsApp
            const whatsappUrl = `https://wa.me/447398538498?text=${encodeURIComponent(
              whatsappMessage
            )}`;
            window.open(whatsappUrl, "_blank");

            // Reset forms
            document.getElementById("oneOffForm").reset();
            document.getElementById("regularForm").reset();

            // Reset price display
            document.getElementById("totalPrice").textContent = "£0.00";
            document.getElementById("serviceType").textContent =
              "Select a service type";
            document.getElementById("houseSize").textContent =
              "Select house size";
            document.getElementById("cleaningFrequency").textContent =
              "Select frequency";
            document.getElementById("priceRange").textContent =
              "Select options to see price range";
            document.getElementById("basePrice").textContent = "£0.00";
            document.getElementById("hourlyRate").textContent = "£0.00";
            document.getElementById("monthlyRate").textContent = "£0.00";
          });

        // Initial update
        updatePrice();
      });
    </script>

    <!-- Stripe JS -->
    <script src="https://js.stripe.com/v3/"></script>

    <!-- Add this JavaScript -->
    <script>
      // Initialize Stripe
      let stripe;

      // Fetch the publishable key from the server
      fetch("/get-stripe-key")
        .then((response) => response.json())
        .then((data) => {
          stripe = Stripe(data.publishableKey);
        })
        .catch((error) => {
          console.error("Error loading Stripe:", error);
        });

      function validateAndSubmit(formId) {
        const form = document.getElementById(formId);
        const requiredFields = form.querySelectorAll("[required]");
        let isValid = true;

        // Reset previous error states
        requiredFields.forEach((field) => {
          field.classList.remove("is-invalid");
        });

        // Validate each required field
        requiredFields.forEach((field) => {
          if (!field.value.trim()) {
            field.classList.add("is-invalid");
            isValid = false;
            // Scroll to first invalid field
            if (isValid === false) {
              field.scrollIntoView({ behavior: "smooth", block: "center" });
              field.focus();
              isValid = null; // Prevent scrolling to other fields
            }
          }
        });

        if (isValid) {
          // console.group("📋 Form Submission Data");
          // console.log("🏠 Cleaning Details:");
          // console.log(
          //   "• Size of House:",
          //   form.querySelector('[name="oneOffRoomSize"]')?.value ||
          //     "Not selected"
          // );
          const formElement =
            document.getElementById("oneOffForm") ||
            document.getElementById("regularForm");
          if (formElement) {
            const cleaningTypeSelect =
              document.getElementById("oneOffCleaningType") ||
              document.getElementById("regularCleaningType");

            if (cleaningTypeSelect) {
              console.log(
                "• Cleaning Type:",
                cleaningTypeSelect.value || "Not selected"
              );
            } else {
              console.log("• Cleaning Type: Select element not found by ID");
              // Fallback to name attribute if ID doesn't work
              const fallbackSelect = formElement.querySelector(
                '[name="oneOffCleaningType"], [name="regularCleaningType"]'
              );
              console.log("Fallback select found:", fallbackSelect);
            }
          } else {
            console.log("• Form not found");
          }

          console.log(
            "  • Preferred Date:",
            form.querySelector('[name="oneOffDate"]')?.value || "Not selected"
          );

          console.log(
            "  • Preferred Time:",
            form.querySelector('[name="oneOffTime"]')?.value || "Not selected"
          );

          // console.log(
          //   "  • Special Instructions:",
          //   form.querySelector('[name="oneOffNotes"]')?.value ||
          //     document.getElementById("oneOffNotes")?.value ||
          //     "Not provided"
          // );
          // console.log(
          //   "  • Email:",
          //   form.querySelector('[name="email"]')?.value ||
          //     document.getElementById("email")?.value ||
          //     "Not provided"
          // );
          // console.log(
          //   "  • Phone:",
          //   form.querySelector('[name="phone"]')?.value ||
          //     document.getElementById("phone")?.value ||
          //     "Not provided"
          // );
          // console.log(
          //   "  • Alternate Phone:",
          //   form.querySelector('[name="alternatePhone"]')?.value ||
          //     document.getElementById("alternatePhone")?.value ||
          //     "Not provided"
          // );

          // console.log("\n🏠 Address Information:");
          // console.log(
          //   "  • Address:",
          //   form.querySelector('[name="address"]')?.value ||
          //     document.getElementById("address")?.value ||
          //     "Not provided"
          // );
          // console.log(
          //   "  • Postcode:",
          //   form.querySelector('[name="postcode"]')?.value ||
          //     document.getElementById("postcode")?.value ||
          //     "Not provided"
          // );
          // console.log(
          //   "  • City:",
          //   form.querySelector('[name="city"]')?.value ||
          //     document.getElementById("city")?.value ||
          //     "Not provided"
          // );
          // console.log(
          //   "  • Country:",
          //   form.querySelector('[name="country"]')?.value ||
          //     document.getElementById("Country")?.value ||
          //     "Not provided"
          // );

          // console.log("\n📝 Special Instructions:");
          // console.log(
          //   "  ",
          //   form.querySelector('[name="oneOffNotes"]')?.value ||
          //     document.getElementById("oneOffNotes")?.value ||
          //     "None provided"
          // );

          // console.groupEnd();

          // Show payment modal if form is valid
          const paymentModal = new bootstrap.Modal(
            document.getElementById("paymentModal")
          );
          paymentModal.show();

          // Store form data for submission after payment method is selected
          window.pendingFormData = {};
          const formElements = form.elements;
          for (let element of formElements) {
            if (element.name) {
              window.pendingFormData[element.name] = element.value;
            } else if (element.id) {
              window.pendingFormData[element.id] = element.value;
            }
          }

          // Store in localStorage
          localStorage.setItem(
            "bookingDetails",
            JSON.stringify(window.pendingFormData)
          );
          console.log("Booking details stored:", window.pendingFormData);
        }
      }

      async function processPayment(paymentMethod) {
        let button = document.querySelector(
          `.payment-option[onclick*="${paymentMethod}"]`
        );
        let originalText = button ? button.innerHTML : "";

        // Get service type (one-off or regular)
        const isRegular =
          document.getElementById("regularSection").style.display === "block";

        // Get selected room size and frequency
        const roomSize = isRegular
          ? document.getElementById("regularRoomSize")?.value || "1-2"
          : document.querySelector('input[name="roomSize"]:checked')?.value ||
            "1-2";

        const frequency = isRegular
          ? document.getElementById("regularFrequency")?.value || "weekly"
          : "one-off";

        // Calculate amount based on service type and frequency
        let selectedAmount = 0;
        if (isRegular) {
          // Use regular cleaning pricing based on frequency
          selectedAmount = frequency === "weekly" ? 13.5 : 15.0;
        } else {
          // Use one-off cleaning pricing based on room size
          if (roomSize === "3-4") selectedAmount = 100.0;
          else if (roomSize === "5+") selectedAmount = 150.0;
          else selectedAmount = 50.0; // Default for 1-2 rooms
        }

        // Update displayed price (sync UI and logic)
        const priceElement = document.getElementById("totalPrice");
        if (priceElement) {
          priceElement.textContent = `£${selectedAmount.toFixed(2)}`;
        }

        const serviceType = isRegular ? "Regular Cleaning" : "One-Off Cleaning";
        const houseSize = `${roomSize} ${
          roomSize.includes("+") ? "Rooms" : "Rooms"
        }`;
        const priceRange =
          document.getElementById("priceRange")?.textContent || "";

        // Combine form fields with price
        const allFormData =
          JSON.parse(localStorage.getItem("bookingDetails")) || {};
        allFormData.totalPrice = `£${selectedAmount.toFixed(2)}`;

        window.pendingFormData = allFormData;

        try {
          if (button) {
            button.innerHTML =
              '<i class="fas fa-spinner fa-spin"></i> Processing...';
            button.disabled = true;
          }

          const amount = parseFloat(
            window.pendingFormData.totalPrice.replace(/[^0-9.]/g, "")
          );

          if (!amount || isNaN(amount)) throw new Error("Invalid price");

          const serviceType =
            window.pendingFormData?.serviceType || "Cleaning Service";
          const houseSize = window.pendingFormData?.houseSize || "1-2 Rooms";

          if (paymentMethod === "paypal") {
            const modalBody = document.querySelector(
              "#paymentModal .modal-body"
            );

            // 💥 Ensure any existing PayPal buttons are wiped out completely
            const existingContainer = document.getElementById(
              "paypal-button-container"
            );
            if (existingContainer) existingContainer.remove();

            modalBody.innerHTML = `
  <div id="paypal-button-container" class="mt-3"></div>
  <p class="mt-3">Processing PayPal payment for <strong>£${amount.toFixed(
    2
  )}</strong></p>
`;
            console.log("PayPal Amount Being Sent:", amount.toFixed(2));

            paypal
              .Buttons({
                createOrder: function (data, actions) {
                  const amount = parseFloat(finalAmount).toFixed(2); // ensure valid number

                  if (!amount || isNaN(amount) || Number(amount) <= 0) {
                    console.error("Invalid PayPal amount:", amount);
                    alert(
                      "Something went wrong. Please check your selected options."
                    );
                    return;
                  }

                  return actions.order.create({
                    purchase_units: [
                      {
                        amount: {
                          value: amount,
                          currency_code: "GBP", // or "USD", etc. depending on your setting
                        },
                      },
                    ],
                  });
                },

                onApprove: function (data, actions) {
                  return actions.order.capture().then(function (details) {
                    sessionStorage.setItem(
                      "receiptData",
                      JSON.stringify(window.pendingFormData)
                    );
                    window.location.href = `/payment-success?orderId=${data.orderID}&payerName=${details.payer.name.given_name}`;
                  });
                },
                onError: function (err) {
                  console.error("PayPal payment failed:", err);
                  alert("PayPal payment failed. Please try again.");
                },
              })
              .render("#paypal-button-container");
          } else if (paymentMethod === "stripe") {
            let button = document.querySelector(
              '.payment-option[onclick*="stripe"]'
            );
            let originalText = button ? button.innerHTML : "";

            try {
              // Show loading state
              if (button) {
                button.innerHTML =
                  '<i class="fas fa-spinner fa-spin"></i> Processing...';
                button.disabled = true;
              }

              // Get the selected number of rooms
              const roomSize =
                document.querySelector('input[name="roomSize"]:checked')
                  ?.value ||
                document.querySelector('select[name="roomSize"]')?.value ||
                "1-2";

              // Set the price based on the number of rooms (in pence for Stripe)
              let amount = 0;
              const serviceType =
                document.getElementById("serviceType").textContent;
              const cleaningType =
                document.getElementById("cleaningType").textContent;
              console.log("Starting amount calculation:", {
                serviceType,
                cleaningType,
              });

              if (serviceType === "One-Off Cleaning") {
                console.log("Processing One-Off Cleaning");
                if (!roomSize || !cleaningType) {
                  console.error("Missing roomSize or cleaningType");
                  alert(
                    "Please select both house size and cleaning type before proceeding."
                  );
                  if (button) {
                    button.innerHTML = originalText;
                    button.disabled = false;
                  }
                  return;
                }

                console.log("Selected room size:", roomSize);
                console.log("Selected cleaning type:", cleaningType);

                const cleanPrice = oneOffPrices[roomSize]?.[cleaningType];
                console.log("Clean price from oneOffPrices:", cleanPrice);

                if (!cleanPrice || cleanPrice < 0.5) {
                  console.error("Invalid clean price:", cleanPrice);
                  alert(
                    "The selected combination does not have a valid price. Please check your selections."
                  );
                  if (button) {
                    button.innerHTML = originalText;
                    button.disabled = false;
                  }
                  return;
                }

                amount = Math.round(cleanPrice * 100);
                console.log("Final calculated amount (in pence):", amount);
              } else if (roomSize === "5+") {
                amount = 15000; // £150.00 in pence
              }

              // Update the displayed price
              const priceElement = document.getElementById("totalPrice");
              if (priceElement) {
                priceElement.textContent = `£${(amount / 100).toFixed(2)}`;
              }

              const isOneOff = serviceType === "One-Off";

              // Get common form elements
              const nameElement = document.getElementById("name");
              const emailElement = document.getElementById("email");
              const phoneElement = document.getElementById("phone");
              const addressElement = document.getElementById("address");
              const postcodeElement = document.getElementById("postcode");
              const cityElement = document.getElementById("city");
              const CountryElement = document.getElementById("country");
              const alternatePhoneElement =
                document.getElementById("alternatePhone");
              const preferredDateElement =
                document.getElementById("preferredDate");
              const preferredTimeElement =
                document.getElementById("preferredTime");

              // Get service-specific elements
              const oneOffDateElement = document.getElementById("oneOffDate");
              const oneOffTimeElement = document.getElementById("oneOffTime");
              const oneOffNotesElement = document.getElementById("oneOffNotes");
              const regularFrequencyElement =
                document.getElementById("cleaningFrequency");
              const regularTimeElement =
                document.getElementById("preferredTime");
              const regularDateElement = document.getElementById("regularDate");
              const regularNotesElement =
                document.getElementById("regularNotes");

              const bookingDetails = {
                serviceType: serviceType,
                houseSize: document.getElementById("houseSize").textContent,
                priceRange: document.getElementById("priceRange").textContent,
                totalPrice: `£${amount.toFixed(2)}`,
                customerName:
                  document.querySelector('[name="fullName"]')?.value || "",
                customerEmail: emailElement ? emailElement.value : "",
                customerPhone: phoneElement ? phoneElement.value : "",
                alternatePhone: alternatePhoneElement
                  ? alternatePhoneElement.value
                  : "",
                address: addressElement ? addressElement.value : "",
                postcode: postcodeElement ? postcodeElement.value : "",
                city: cityElement ? cityElement.value : "",
                country:
                  document.querySelector('[name="country"]')?.value ||
                  CountryElement?.value ||
                  "",
                oneOffDate:
                  isOneOff && oneOffDateElement ? oneOffDateElement.value : "",
                oneOffTime:
                  isOneOff && oneOffTimeElement ? oneOffTimeElement.value : "",
                notes: isOneOff
                  ? oneOffNotesElement
                    ? oneOffNotesElement.value
                    : ""
                  : regularNotesElement
                  ? regularNotesElement.value
                  : "",
                cleaningFrequency:
                  !isOneOff && regularFrequencyElement
                    ? regularFrequencyElement.value
                    : "",
                preferredTime:
                  !isOneOff && regularTimeElement
                    ? regularTimeElement.value
                    : "",
                preferredDate:
                  !isOneOff && regularDateElement
                    ? regularDateElement.value
                    : "",
              };

              // Convert booking details to URL parameters
              const urlParams = new URLSearchParams();

              // Add all booking details to URL parameters
              Object.entries(bookingDetails).forEach(([key, value]) => {
                if (value) urlParams.append(key, value);
              });

              // Explicitly add oneOffDate and oneOffTime from the form
              const oneOffDate = document.querySelector(
                '[name="oneOffDate"]'
              )?.value;
              const oneOffTime = document.querySelector(
                '[name="oneOffTime"]'
              )?.value;

              if (oneOffDate) urlParams.set("oneOffDate", oneOffDate);
              if (oneOffTime) urlParams.set("oneOffTime", oneOffTime);

              console.log("Raw amount from form:", amount);
              console.log(
                "Converted amount to pence:",
                Math.round(parseFloat(amount) * 100)
              );

              // Extract numeric value from priceRange (e.g., "£130.00" -> 13000 pence)
              const priceInPounds = parseFloat(
                bookingDetails.priceRange.replace(/[^0-9.]/g, "")
              );
              const amountInPence = Math.round(priceInPounds * 100);

              console.log("Price from priceRange:", bookingDetails.priceRange);
              console.log("Amount in pence:", amountInPence);

              // Create payment intent data with success URL containing all parameters
              const paymentIntentData = {
                amount: amountInPence, // Use the converted price from priceRange
                currency: "gbp",
                metadata: {
                  serviceType: bookingDetails.serviceType,
                  houseSize: bookingDetails.houseSize,
                  priceRange: bookingDetails.priceRange,
                  totalPrice: bookingDetails.priceRange, // Use the original priceRange value
                  customerName: bookingDetails.customerName || "",
                  customerEmail: bookingDetails.customerEmail || "",
                  customerPhone: bookingDetails.customerPhone || "",
                  address: bookingDetails.address || "",
                  postcode: bookingDetails.postcode || "",
                  city: bookingDetails.city || "",
                  country: bookingDetails.country || "",
                  notes: bookingDetails.notes || "",
                  oneOffDate: oneOffDate || "",
                  oneOffTime: oneOffTime || "",
                  cleaningFrequency: bookingDetails.cleaningFrequency || "",
                  preferredTime: bookingDetails.preferredTime || "",
                  preferredDate: bookingDetails.preferredDate || "",
                },
                success_url: `${
                  window.location.origin
                }/payment-success.html?${urlParams.toString()}`,
                cancel_url: `${window.location.origin}/pricing.html`,
              };

              console.log("Payment intent data being sent:", {
                ...paymentIntentData,
                amount: `£${(paymentIntentData.amount / 100).toFixed(2)} (${
                  paymentIntentData.amount
                } pence)`,
              });

              // Create a payment intent on your server
              const response = await fetch("/create-payment-intent", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(paymentIntentData),
              });

              if (!response.ok) {
                const error = await response.json();
                throw new Error(
                  error.error || "Failed to create payment intent"
                );
              }

              const { clientSecret } = await response.json();

              // Create a modal for payment details
              const modal = document.createElement("div");
              modal.style.position = "fixed";
              modal.style.top = "0";
              modal.style.left = "0";
              modal.style.width = "100%";
              modal.style.height = "100vh";
              modal.style.backgroundColor = "rgba(0,0,0,0.5)";
              modal.style.display = "flex";
              modal.style.justifyContent = "center";
              modal.style.alignItems = "center";
              modal.style.zIndex = "9999";

              const modalContent = document.createElement("div");
              modalContent.style.backgroundColor = "white";
              modalContent.style.padding = "20px";
              modalContent.style.borderRadius = "8px";
              modalContent.style.width = "90%";
              modalContent.style.maxWidth = "500px";
              modalContent.style.maxHeight = "90vh";
              modalContent.style.overflowY = "auto";

              // Create service summary HTML
              const serviceSummary = `
              <div style="margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px;">
                <h5 style="margin-bottom: 10px; color: #333;">Service Summary</h5>
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                  <span style="color: #666;">Service Type:</span>
                  <span style="font-weight: 500;">${bookingDetails.serviceType}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                  <span style="color: #666;">House Size:</span>
                  <span style="font-weight: 500;">${bookingDetails.houseSize}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                  <span style="color: #666;">Price Range:</span>
                  <span style="font-weight: 500;">${bookingDetails.priceRange}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 10px; padding-top: 10px; border-top: 1px dashed #eee;">
                  <span style="font-weight: bold;">Total Amount:</span>
                  <span style="font-weight: bold; font-size: 1.2em;">${bookingDetails.priceRange}</span>
                </div>
              </div>
            `;

              modalContent.innerHTML = `
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h4 style="margin: 0;">Complete Payment</h4>
                <button id="close-payment" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">&times;</button>
              </div>
              ${serviceSummary}
              <div id="payment-element"></div>
              <div style="margin-top: 20px; text-align: right;">
                <button id="submit-payment" class="btn btn-primary">
                  <span id="button-text">Pay Now</span>
                  <span id="spinner" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i>
                  </span>
                </button>
              </div>
              <div id="payment-message" class="hidden" style="color: #e74c3c; margin-top: 15px; font-size: 0.9rem;"></div>
            `;

              modal.appendChild(modalContent);
              document.body.appendChild(modal);
              document.body.style.overflow = "hidden"; // Prevent background scrolling

              // Initialize Stripe Elements with the clientSecret
              const elements = stripe.elements({
                clientSecret: clientSecret,
                appearance: {
                  theme: "stripe",
                  variables: {
                    colorPrimary: "#4a90e2",
                  },
                },
              });

              // Create and mount the Payment Element
              const paymentElement = elements.create("payment");
              paymentElement.mount("#payment-element");

              // Handle form submission
              const form = document.createElement("form");
              form.id = "payment-form";

              // Handle payment submission
              document
                .getElementById("submit-payment")
                .addEventListener("click", async (e) => {
                  e.preventDefault();

                  const submitButton =
                    document.getElementById("submit-payment");
                  const spinner = document.getElementById("spinner");
                  const buttonText = document.getElementById("button-text");
                  const paymentMessage =
                    document.getElementById("payment-message");

                  // Show spinner and disable button
                  submitButton.disabled = true;
                  buttonText.style.display = "none";
                  spinner.style.display = "inline-block";
                  paymentMessage.textContent = "";
                  paymentMessage.style.display = "none";

                  try {
                    const { error } = await stripe.confirmPayment({
                      elements,
                      confirmParams: {
                        return_url: `${
                          window.location.origin
                        }/payment-success?${urlParams.toString()}`,
                        receipt_email: bookingDetails.customerEmail || "",
                      },
                    });

                    if (error) {
                      throw error;
                    }
                  } catch (error) {
                    console.error("Payment error:", error);
                    paymentMessage.textContent =
                      error.message || "An unexpected error occurred.";
                    paymentMessage.style.display = "block";
                    submitButton.disabled = false;
                    buttonText.style.display = "inline";
                    spinner.style.display = "none";
                  }
                });

              // Handle close button
              document
                .getElementById("close-payment")
                .addEventListener("click", () => {
                  closePaymentModal();
                });

              // Close modal when clicking outside
              modal.addEventListener("click", (e) => {
                if (e.target === modal) {
                  closePaymentModal();
                }
              });

              // Function to close the payment modal
              const closePaymentModal = () => {
                document.body.removeChild(modal);
                document.body.style.overflow = "auto";
                if (button) {
                  button.innerHTML = originalText;
                  button.disabled = false;
                }
              };
            } catch (error) {
              console.error("Payment error:", error);
              alert(
                "Payment failed: " + (error.message || "Something went wrong")
              );
              // Reset button state
              if (button) {
                button.innerHTML = originalText;
                button.disabled = false;
              }
            }
          } else if (paymentMethod === "paypal") {
            const bookingDetails = { ...window.pendingFormData };

            const amount = parseFloat(
              bookingDetails.totalPrice.replace(/[^0-9.]/g, "")
            );

            console.log("PayPal Amount Being Sent:", amount); // Debug check

            const modalBody = document.querySelector(
              "#paymentModal .modal-body"
            );
            modalBody.innerHTML = `
    <div id="paypal-button-container" class="mt-3"></div>
    <p class="mt-3">Processing PayPal payment for <strong>£${amount.toFixed(
      2
    )}</strong></p>
  `;

            paypal
              .Buttons({
                createOrder: function (data, actions) {
                  return actions.order.create({
                    purchase_units: [
                      {
                        amount: {
                          value: amount.toFixed(2),
                          currency_code: "GBP",
                          breakdown: {
                            item_total: {
                              currency_code: "GBP",
                              value: amount.toFixed(2),
                            },
                          },
                        },
                        description: `${bookingDetails.serviceType} - ${bookingDetails.houseSize}`,
                      },
                    ],
                  });
                },
                onApprove: function (data, actions) {
                  return actions.order.capture().then(function (details) {
                    sessionStorage.setItem(
                      "receiptData",
                      JSON.stringify(window.pendingFormData)
                    );
                    window.location.href = `/payment-success?orderId=${data.orderID}&payerName=${details.payer.name.given_name}`;
                  });
                },
                onError: function (err) {
                  console.error("PayPal payment failed:", err);
                  alert("PayPal payment failed. Please try again.");
                },
              })
              .render("#paypal-button-container");
          }
        } catch (error) {
          console.error("Payment error:", error);
          alert("Payment failed: " + (error.message || "Something went wrong"));
          if (button) {
            button.innerHTML = originalText;
            button.disabled = false;
          }
        }
      }
    </script>

    <!-- Add this CSS to your existing styles -->
    <style>
      .payment-option {
        transition: transform 0.2s, box-shadow 0.2s;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
      }
      .payment-option:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
    </style>

    <!-- Payment Modal -->
    <div
      class="modal fade"
      id="paymentModal"
      tabindex="-1"
      aria-labelledby="paymentModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5
              class="modal-title"
              id="paymentModalLabel"
              style="color: #000000"
            >
              Select Payment Method
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body text-center">
            <p class="mb-4">Please choose your preferred payment method:</p>
            <div class="d-flex justify-content-center align-items-center gap-4">
              <!-- PayPal Button with square border -->
              <div
                class="payment-option"
                style="
                  border: 1px solid #ddd;
                  border-radius: 4px;
                  padding: 34px 110px;
                  width: 200px;
                "
              >
                <div id="paypal-button-container"></div>
              </div>

              <!-- Stripe Button -->
              <div
                class="payment-option"
                onclick="processPayment('stripe')"
                style="
                  cursor: pointer;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                  padding: 31px;
                  width: 200px;
                "
              >
                <img
                  src="img/stripe.png"
                  alt="Stripe"
                  class="img-fluid"
                  style="max-width: 120px"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function initializePayPalButton() {
        // Get the room size from the form
        function getSelectedRoomSize() {
          const activeForm =
            document.getElementById("oneOffSection").style.display === "block"
              ? "oneOff"
              : "regular";
          const roomSizeSelect = document.getElementById(
            `${activeForm}RoomSize`
          );
          return roomSizeSelect ? roomSizeSelect.value : null;
        }

        // Calculate price based on room size
        function calculatePrice() {
          const roomSize = getSelectedRoomSize();
          switch (roomSize) {
            case "1-2":
              return "50.00";
            case "3-4":
              return "100.00";
            case "5+":
              return "150.00";
            default:
              return "0.00";
          }
        }

        // Update PayPal button when room size changes
        function updatePayPalButton() {
          const roomSize = getSelectedRoomSize();
          const price = calculatePrice();
          const container = document.getElementById("paypal-button-container");

          // Only enable PayPal button if a room size is selected
          if (roomSize) {
            container.style.display = "block";

            // Clean up any existing PayPal button
            if (window.paypalButtonInstance) {
              window.paypalButtonInstance.close();
              window.paypalButtonInstance = null;
            }

            // Clear the container
            container.innerHTML = "";

            // Create new PayPal button
            window.paypalButtonInstance = paypal.Buttons({
              createOrder: function (data, actions) {
                return actions.order.create({
                  purchase_units: [
                    {
                      amount: {
                        value: price,
                        currency_code: "GBP",
                      },
                    },
                  ],
                });
              },
              onApprove: function (data, actions) {
                return actions.order.capture().then(function (details) {
                  alert(
                    "Transaction completed by " + details.payer.name.given_name
                  );
                  // Add any additional success handling here
                });
              },
              onError: function (err) {
                console.error("PayPal error:", err);
                // Handle errors here
              },
            });

            // Render the PayPal button
            if (window.paypalButtonInstance) {
              window.paypalButtonInstance.render("#paypal-button-container");
            }
          } else {
            container.style.display = "none";
          }
        }

        // Add event listeners to room size selectors
        document
          .getElementById("oneOffRoomSize")
          ?.addEventListener("change", updatePayPalButton);
        document
          .getElementById("regularRoomSize")
          ?.addEventListener("change", updatePayPalButton);

        // Initialize the button
        updatePayPalButton();
      }

      // Initialize PayPal button when the page loads
      document.addEventListener("DOMContentLoaded", function () {
        // Other existing code...

        // Initialize PayPal button
        if (typeof paypal !== "undefined") {
          initializePayPalButton();
        } else {
          console.error("PayPal SDK not loaded");
        }
      });
    </script>
    <!-- Footer Start -->
    <div
      class="container-fluid footer bg-footer py-5 wow fadeIn"
      data-wow-delay="0.2s"
    >
      <div class="container py-5">
        <div class="row g-4">
          <div class="col-md-6 col-lg-6 col-xl-4">
            <div class="footer-item d-flex flex-column">
              <div class="footer-item">
                <h3 class="mb-4">
                  <img
                    src="img/testing-logo-2.png"
                    alt="Well-Clean"
                    style="height: 70px"
                  />
                </h3>
                <p class="mb-3">
                  Well Clean is dedicated to providing top-notch cleaning
                  services for both residential and commercial spaces using
                  eco-friendly products and advanced cleaning techniques.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-6 col-xl-3">
            <div class="footer-item d-flex flex-column">
              <h4 class="mb-4">About Us</h4>
              <a href="about.html"
                ><i class="fas fa-angle-right me-2"></i> About</a
              >
              <a href="service.html"
                ><i class="fas fa-angle-right me-2"></i> Services</a
              >
              <a href="about.html"
                ><i class="fas fa-angle-right me-2"></i> Why Choose Us</a
              >
              <a href="contact.html"
                ><i class="fas fa-angle-right me-2"></i> Contact us</a
              >
              <a href="index.html#faq-section"
                ><i class="fas fa-angle-right me-2"></i> FAQs</a
              >
              <a href="terms-conditions.html"
                ><i class="fas fa-angle-right me-2"></i> Terms & Conditions</a
              >
            </div>
          </div>
          <div class="col-md-6 col-lg-6 col-xl-3">
            <div class="footer-item d-flex flex-column">
              <h4 class="mb-4">Business Hours</h4>
              <div class="mb-3">
                <h6 class="text-muted mb-0">Mon - Friday:</h6>
                <p class="mb-0">09.00 am to 07.00 pm</p>
              </div>
              <div class="mb-3">
                <h6 class="text-muted mb-0">Saturday:</h6>
                <p class="mb-0">10.00 am to 05.00 pm</p>
              </div>
              <div class="mb-3">
                <h6 class="text-muted mb-0">Sunday:</h6>
                10:00am to 5:00pm
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-6 col-xl-2">
            <div class="footer-item d-flex flex-column">
              <h4 class="mb-4">Contact Info</h4>
              <!-- <a 
                ><i class="fa fa-map-marker-alt me-2"></i> 123 Street, New York,
                USA</a
              > -->
              <a href="mailto:info@wellclean.com"
                ><i class="fas fa-envelope me-2"></i> info@wellclean.com</a
              >

              <a href="tel:+441733964472"
                ><i class="fas fa-phone me-2"></i> +441733964472</a
              >
              <a href="tel:+447427783539" class="mb-3"
                ><i class="fab fa-whatsapp me-2"></i> +44 7427 783539</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer End -->

    <!-- Copyright Start -->
    <div class="container-fluid copyright py-4">
      <div class="container">
        <div class="row g-4 align-items-center">
          <div class="col-md-6 text-center text-md-start mb-md-0">
            <span class="text-body">
              <a class="border-bottom" style="border-bottom: none !important">
                <i class="fas fa-copyright text-light me-2"></i>
                Well Clean
              </a>
              <span id="year"></span> All rights reserved.
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Copyright End -->

    <!-- Back to Top -->
    <a class="btn btn-secondary btn-lg-square rounded-circle back-to-top"
      ><i class="fa fa-arrow-up"></i
    ></a>

    <!-- JavaScript Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
    <script src="js/script.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get all necessary elements safely
        const oneOffBtn = document.getElementById("oneOffBtn");
        const regularBtn = document.getElementById("regularBtn");
        const oneOffSection = document.getElementById("oneOffSection");
        const regularSection = document.getElementById("regularSection");

        const bookingModalEl = document.getElementById("bookingDetailsModal");
        const oneOffRoomSizeEl = document.getElementById("oneOffRoomSize");
        const regularRoomSizeEl = document.getElementById("regularRoomSize");
        const regularFrequencyEl = document.getElementById("regularFrequency");

        const oneOffForm = document.getElementById("oneOffForm");
        const regularForm = document.getElementById("regularForm");
        const confirmBookingBtn = document.getElementById("confirmBooking");

        let bookingModal = null;
        if (bookingModalEl) {
          bookingModal = new bootstrap.Modal(bookingModalEl);
        }

        const oneOffPrices = {
          "1-bed flat": { Light: 45, Standard: 55, Deep: 100 },
          "2-bed, 1-bath": { Light: 60, Standard: 70, Deep: 120 },
          "3-bed, 1-2 bath": { Light: 70, Standard: 85, Deep: 145 },
          "4-bed, 2-bath": { Light: 90, Standard: 130, Deep: 180 },
          "5-bed, 2-3 bath": { Light: 110, Standard: 150, Deep: 225 },
          "6+ bedrooms / large homes": { Light: 130, Standard: 200, Deep: 275 },
        };

        function updatePrice() {
          const serviceType =
            oneOffSection.style.display === "block" ? "one-off" : "regular";

          const cleaningType =
            serviceType === "one-off"
              ? document.getElementById("oneOffCleaningType").value
              : document.getElementById("regularCleaningType").value;

          const roomSize =
            serviceType === "one-off"
              ? document.getElementById("oneOffRoomSize").value
              : document.getElementById("regularRoomSize").value;

          const frequency = document.getElementById("regularFrequency")?.value;

          // Update service type
          document.getElementById("serviceType").textContent =
            serviceType === "one-off" ? "One-Off Clean" : "Regular Cleaning";

          // Update house size
          document.getElementById("houseSize").textContent = roomSize
            ? roomSize
            : "Select house size";

          // Update cleaning type
          document.getElementById("cleaningType").textContent = cleaningType
            ? cleaningType === "Light"
              ? "Light Clean"
              : cleaningType === "Standard"
              ? "Standard Clean"
              : "Deep Clean"
            : "Select cleaning type";

          // Show/hide frequency section
          const frequencySection = document.getElementById("frequencySection");
          if (serviceType === "regular") {
            frequencySection.style.display = "block";
            document.getElementById("cleaningFrequency").textContent = frequency
              ? frequency === "weekly"
                ? "Weekly/Bi-Weekly"
                : "Monthly"
              : "Select frequency";
          } else {
            frequencySection.style.display = "none";
          }

          if (roomSize) {
            if (serviceType === "one-off") {
              const price = oneOffPrices[roomSize]?.[cleaningType] || 0;
              document.getElementById(
                "totalPrice"
              ).textContent = `£${price.toFixed(2)}`;
              document.getElementById(
                "basePrice"
              ).textContent = `£${price.toFixed(2)}`;
              document.getElementById("priceRange").textContent =
                price > 0
                  ? `£${price.toFixed(2)}`
                  : "Select options to see price";

              // Hide hourly/monthly sections
              document.getElementById("hourlyRateSection").style.display =
                "none";
              document.getElementById("monthlyRateSection").style.display =
                "none";
            } else if (frequency) {
              const rate = priceData["regular"][frequency];
              document.getElementById(
                "totalPrice"
              ).textContent = `£${rate.toFixed(2)}`;
              document.getElementById(
                "hourlyRate"
              ).textContent = `£${rate.toFixed(2)}`;
              document.getElementById("priceRange").textContent =
                frequency === "weekly"
                  ? `£13.50hr (with cleaning supplies provided)`
                  : `£15 per hour`;

              // Show hourly rate section, hide monthly rate
              document.getElementById("hourlyRateSection").style.display =
                "block";
              document.getElementById("monthlyRateSection").style.display =
                "none";
            }
          } else {
            // Reset prices if no selection
            document.getElementById("totalPrice").textContent = "£0.00";
            document.getElementById("serviceType").textContent =
              "Select a service type";
            document.getElementById("houseSize").textContent =
              "Select house size";
            document.getElementById("cleaningFrequency").textContent =
              "Select frequency";
            document.getElementById("priceRange").textContent =
              "Select options to see price range";
            document.getElementById("basePrice").textContent = "£0.00";
            document.getElementById("hourlyRate").textContent = "£0.00";
            document.getElementById("monthlyRate").textContent = "£0.00";
          }
        }

        // Event listeners with null checks
        if (oneOffBtn && regularBtn && oneOffSection && regularSection) {
          oneOffBtn.addEventListener("click", function () {
            oneOffSection.style.display = "block";
            regularSection.style.display = "none";
            oneOffBtn.classList.add("btn-primary");
            oneOffBtn.classList.remove("btn-secondary");
            regularBtn.classList.add("btn-secondary");
            regularBtn.classList.remove("btn-primary");
            updatePrice();
          });

          regularBtn.addEventListener("click", function () {
            regularSection.style.display = "block";
            oneOffSection.style.display = "none";
            regularBtn.classList.add("btn-primary");
            regularBtn.classList.remove("btn-secondary");
            oneOffBtn.classList.add("btn-secondary");
            oneOffBtn.classList.remove("btn-primary");
            updatePrice();
          });
        }

        [
          "oneOffRoomSize",
          "regularRoomSize",
          "regularFrequency",
          "oneOffCleaningType",
          "regularCleaningType",
        ].forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.addEventListener("change", updatePrice);
        });

        function getBookingDetailsFromForm() {
          const serviceType =
            document.getElementById("oneOffSection").style.display === "block"
              ? "one-off"
              : "regular";

          // Get common elements
          const fullName = document.getElementById("fullName")?.value || "";
          const email = document.getElementById("email")?.value || "";
          const phone = document.getElementById("phone")?.value || "";
          const alternatePhone =
            document.getElementById("alternatePhone")?.value || "";
          const address = document.getElementById("address")?.value || "";
          const postcode = document.getElementById("postcode")?.value || "";
          const city = document.getElementById("city")?.value || "";
          const country = document.getElementById("country")?.value || "";
          const notes =
            document.getElementById(
              serviceType === "one-off" ? "oneOffNotes" : "regularNotes"
            )?.value || "";

          if (serviceType === "one-off") {
            // One-off specific fields
            const roomSize =
              document.getElementById("oneOffRoomSize")?.value || "";
            const cleaningType =
              document.getElementById("oneOffCleaningType")?.value || "";
            const date = document.getElementById("oneOffDate")?.value || "";
            const time = document.getElementById("oneOffTime")?.value || "";

            const houseSize =
              roomSize === "1-2"
                ? "1-2 Rooms"
                : roomSize === "3-4"
                ? "3-4 Rooms"
                : roomSize === "5+"
                ? "5+ Rooms"
                : "";

            const cleaningTypeDisplay =
              cleaningType === "Light"
                ? "Light Clean"
                : cleaningType === "Standard"
                ? "Standard Clean"
                : cleaningType === "Deep"
                ? "Deep Clean"
                : "";

            return {
              serviceType: "One-Off Cleaning",
              cleaningType: cleaningTypeDisplay,
              cleaningTypeLabel: cleaningType,
              roomSize,
              houseSize,
              date,
              time,
              preferredDate: date,
              preferredTime: time,
              customerName: fullName,
              fullName,
              email,
              phone,
              alternatePhone,
              alternatePhoneNumber: alternatePhone,
              address,
              streetAddress: address,
              postcode,
              zipCode: postcode,
              city,
              country,
              notes,
              specialInstructions: notes,
              status: "pending",
              timestamp: new Date().toISOString(),
            };
          } else {
            // Regular cleaning specific fields
            const roomSize =
              document.getElementById("regularRoomSize")?.value || "";
            const frequency =
              document.getElementById("regularFrequency")?.value || "";
            const date = document.getElementById("regularDate")?.value || "";

            const houseSize =
              roomSize === "1-2"
                ? "1-2 Rooms"
                : roomSize === "3-4"
                ? "3-4 Rooms"
                : roomSize === "5+"
                ? "5+ Rooms"
                : "";

            const frequencyDisplay =
              frequency === "weekly"
                ? "Weekly/Bi-Weekly"
                : frequency === "monthly"
                ? "Monthly"
                : "";

            return {
              serviceType: "Regular Cleaning",
              frequency: frequencyDisplay,
              frequencyValue: frequency,
              roomSize,
              houseSize,
              date,
              preferredDate: date,
              customerName: fullName,
              fullName,
              email,
              phone,
              alternatePhone,
              alternatePhoneNumber: alternatePhone,
              address,
              streetAddress: address,
              postcode,
              zipCode: postcode,
              city,
              country,
              notes,
              specialInstructions: notes,
              status: "pending",
              timestamp: new Date().toISOString(),
            };
          }
        }

        // Form submission handlers
        if (oneOffForm) {
          oneOffForm.addEventListener("submit", function (e) {
            e.preventDefault();
            const bookingDetails = getBookingDetails();
            if (bookingModal) bookingModal.show();
          });
        }

        if (regularForm) {
          regularForm.addEventListener("submit", function (e) {
            e.preventDefault();
            const bookingDetails = getBookingDetails();
            if (bookingModal) bookingModal.show();
          });
        }

        if (confirmBookingBtn) {
          confirmBookingBtn.addEventListener("click", function () {
            const bookingDetails = getBookingDetails();

            const customerDetails = {
              fullName: document.getElementById("fullName")?.value || "",
              email: document.getElementById("email")?.value || "",
              phone: document.getElementById("phone")?.value || "",
              address: document.getElementById("address")?.value || "",
              postcode: document.getElementById("postcode")?.value || "",
              city: document.getElementById("city")?.value || "",
              country: document.getElementById("Country")?.value || "",
              preferredDate:
                document.getElementById("preferredDate")?.value || "",
              preferredTime:
                document.getElementById("preferredTime")?.value || "",
              additionalNotes:
                document.getElementById("regularNotes")?.value || "",
            };

            // console.log("Customer Details:", customerDetails);

            // Combine all data
            const bookingData = {
              ...bookingDetails,
              ...customerDetails,
              timestamp: new Date().toLocaleString("en-GB", {
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
                hour12: true,
              }),
              status: "pending",
            };

            // Send booking data
            const whatsappMessage = `
          *New Booking Request*
          
          *Customer Details:*
          Name: ${bookingData.fullName}
          Email: ${bookingData.email}
          Phone: ${bookingData.phone}
          Alternate Phone: ${bookingData.alternatePhone}
          
          *Address:*
          ${bookingData.address}
          Postcode: ${bookingData.postcode}
          City: ${bookingData.city}
          Country: ${bookingData.country}
          
          *Service Details:*
          Service Type: ${bookingData.serviceType}
          House Size: ${bookingData.houseSize}
          ${
            bookingData.serviceType === "Regular"
              ? `Frequency: ${bookingData.time}\n`
              : `Preferred Time: ${bookingData.time}\nPreferred Time: ${bookingData.preferredTime}\n`
          }
          
          *Additional Notes:*
          ${bookingData.notes}
          
          Status: ${bookingData.status}
          Timestamp: ${bookingData.timestamp}
        `;

            // Open WhatsApp
            const whatsappUrl = `https://wa.me/447398538498?text=${encodeURIComponent(
              whatsappMessage
            )}`;
            window.open(whatsappUrl, "_blank");

            // Hide modals
            document.getElementById("bookingDetailsModal") &&
              new bootstrap.Modal(
                document.getElementById("bookingDetailsModal")
              ).hide();
            document.getElementById("termsModal") &&
              new bootstrap.Modal(document.getElementById("termsModal")).hide();

            // Reset forms
            oneOffForm?.reset();
            regularForm?.reset();
            document.getElementById("bookingDetailsForm")?.reset();

            // Reset prices
            document.getElementById("totalPrice").textContent = "£0.00";
            document.getElementById("serviceType").textContent =
              "Select a service type";
            document.getElementById("houseSize").textContent =
              "Select house size";
            document.getElementById("cleaningFrequency").textContent =
              "Select frequency";
            document.getElementById("priceRange").textContent =
              "Select options to see price range";
            document.getElementById("basePrice").textContent = "£0.00";
            document.getElementById("hourlyRate").textContent = "£0.00";
            document.getElementById("monthlyRate").textContent = "£0.00";
          });
        }

        // Initialize price once
        updatePrice();
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AboK-oq6nnplV5UVW9djS7-Q5z6iZjZjzzR2vD6IQnThL1twuIlL4Khla8kSKgfBInLF9EqZtyxpSJ9i&currency=GBP"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(() => {
          paypal
            .Buttons({
              createOrder: function (data, actions) {
                const amount = parseFloat(finalAmount); // DON'T fix to 2 decimals yet

                // ✅ Guard clause: check if amount is valid and > 0
                if (!amount || isNaN(amount) || amount <= 0) {
                  console.error("Invalid PayPal amount:", amount);
                  alert(
                    "Total amount must be greater than zero. Please check your selected options."
                  );
                  return actions.reject(); // Reject the order creation
                }

                // ✅ Safe to proceed
                return actions.order.create({
                  purchase_units: [
                    {
                      amount: {
                        value: amount.toFixed(2), // Final formatting here
                        currency_code: "GBP",
                      },
                    },
                  ],
                });
              },

              onApprove: function (data, actions) {
                return actions.order.capture().then(function (details) {
                  sessionStorage.setItem(
                    "receiptData",
                    JSON.stringify(window.pendingFormData)
                  );
                  window.location.href = `/payment-success?orderId=${data.orderID}&payerName=${details.payer.name.given_name}`;
                });
              },

              onError: function (err) {
                console.error("PayPal payment failed:", err);
                alert("PayPal payment failed. Please try again.");
              },
            })
            .render("#paypal-button-container");
        }, 500);
      });
    </script>

    <script>
      // Get references to the two buttons
      const oneOffBtn = document.getElementById("oneOffBtn");
      const regularBtn = document.getElementById("regularBtn");

      // Add a click listener to the "One-off" button
      oneOffBtn.addEventListener("click", () => {
        // Add 'active' to this button and remove it from the other
        oneOffBtn.classList.add("active");
        regularBtn.classList.remove("active");
      });

      // Add a click listener to the "Regular" button
      regularBtn.addEventListener("click", () => {
        // Add 'active' to this button and remove it from the other
        regularBtn.classList.add("active");
        oneOffBtn.classList.remove("active");
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const cleanTypeLink = document.getElementById("cleanTypeLink");
        const cleanTypeContent = document.getElementById("cleanTypeContent");

        const cleanTypeHTML = `
    <h5 style="color: #19409A; margin-bottom: 20px;">Clean Type Descriptions</h5>
      <h6 style="color: #19409A;">🧽 Light Clean *</h6>
      <p>
        Perfect for busy professionals or weekly upkeep. A quick refresh including light dusting, vacuuming, mopping, wiping kitchen surfaces, basic bathroom clean, disinfecting high-touch areas, and bin emptying.<br>
        <strong>Ideal for:</strong> 1–2 bed tidy homes<br>
        <strong>Duration:</strong> ~2.5 hours
      </p>

      <h6 style="color: #19409A;">🧽 Standard Clean *</h6>
      <p>
        A deeper regular clean covering full dusting, vacuuming, mopping, kitchen surfaces, hob, exterior appliances, and full bathroom clean.<br>
        <strong>Ideal for:</strong> Weekly/fortnightly maintenance<br>
        <strong>Duration:</strong> 3–6 hours depending on property size
      </p>

      <h6 style="color: #19409A;">🧽 Deep Clean *</h6>
      <p>
        A top-to-bottom clean including everything in Light & Standard Clean, plus skirting boards, sockets, internal windows, kitchen cupboards, oven, fridge, tiles, grout, extractor fans, and more.<br>
        <strong>Ideal for:</strong> Spring cleans, post-renovation, or neglected spaces<br>
        <strong>Duration:</strong> 4–8+ hours
      </p>

      <h6 style="color: #19409A;">🧽 End of Tenancy / Moving Out *</h6>
      <p>
        Designed to meet landlord/agency standards. Includes deep clean plus any specific requests like inside appliances, windows, walls, and all hidden areas.<br>
        <strong>Ideal for:</strong> Tenants, landlords, estate agents<br>
        <strong>Duration:</strong> Varies – please ask for a <a href="index.html#openEstimateModal" style="color: #19409A; text-decoration: underline; cursor: pointer;">quote</a>

      </p>

      <h6 style="color: #19409A;">🧽 Airbnb / Short Let Turnaround *</h6>
      <p>
        Quick, efficient reset between guests. Includes surface wipe-down, fresh linens (if provided), bin emptying, bathroom & kitchen clean, and tidy-up.<br>
        <strong>Ideal for:</strong> Hosts needing fast, reliable service<br>
        <strong>Duration:</strong> Varies by size & turnover time
      </p>

      <hr>

      
    `;

        cleanTypeLink.addEventListener("click", (e) => {
          e.preventDefault();
          cleanTypeContent.innerHTML = cleanTypeHTML;
          const modal = new bootstrap.Modal(
            document.getElementById("cleanTypeModal")
          );
          modal.show();
        });
      });
    </script>
    <script>
      function updateNavbarVisibility() {
        const navbarCollapse = document.getElementById("navbarCollapse");
        if (window.innerWidth > 991.98) {
          navbarCollapse.classList.add("show");
        } else {
          navbarCollapse.classList.remove("show");
        }
      }

      updateNavbarVisibility();

      document
        .querySelector(".navbar-toggler")
        .addEventListener("click", function () {
          if (window.innerWidth <= 991.98) {
            document.getElementById("navbarCollapse").classList.toggle("show");
          }
        });
      window.addEventListener("resize", updateNavbarVisibility);
    </script>

    <!-- Clean Type Details Modal -->
    <div
      class="modal fade"
      id="cleanTypeModal"
      tabindex="-1"
      aria-labelledby="cleanTypeModalLabel"
      aria-hidden="true"
    >
      <div
        class="modal-dialog modal-xl modal-dialog-centered modal-scrollable custom-clean-type-modal"
      >
        <div class="modal-content clean-type-modal-content">
          <div class="modal-body clean-type-modal-body" id="cleanTypeContent">
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>

            <!-- Filled by JS -->
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
